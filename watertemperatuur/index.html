<!DOCTYPE html>
<html>
<body>

<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/OpenLayers.js"></script>
<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/proj4js-compressed.js"></script>
<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/OpenLayersPdokKaartExtenders.js"></script>
<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/pdok-api.js"></script>
<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/geozetlib.js"></script>
<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/pdok-markers.js"></script>
<script type="text/javascript" src="http://pdokserver/pdokkaart/api/js/pdok-layers.js"></script>
<script type="text/javascript" src="../rws.js"></script>
<link rel="stylesheet" href="../rws.css" type="text/css" />
<script type="text/javascript">
Pdok.addcss("http://pdokserver/pdokkaart/api/styles/default/style.css");
Pdok.addcss("http://pdokserver/pdokkaart/api/styles/api.css");
var config_762={
    "mapdiv":"map_762",
    "zoom":4,
    "showlayerswitcher":true,
    "showzoom":true,
    "shownavigation":true,
    "showscaleline":true,
    "showmouseposition":true,
    "loc":"122650.88, 487337.6",
    "baselayers":[{"id":"BRT","visible":true}],
    "markersdef":"http://pdokserver/pdokkaart/api/js/pdok-markers.js",
    "layersdef":"http://pdokserver/pdokkaart/api/js/pdok-layers.js"};
var api;
Pdok.ready( 
function(){ 
    api = new Pdok.Api(config_762);

    api.map.getLayersByName('Markers')[0].setName('Watertemperatuur');
    //api.map.layers[0].setOpacity(0.5)

     function handler(request) {
        var obj = JSON.parse(request.responseText);
        var features = [];
        //for (var i=0;i<obj.features.length;i++) {
        for (var i=0;i<30;i++) {
            var data = obj.features[i];
            var feature = new OpenLayers.Feature.Vector(
                    new OpenLayers.Geometry.Point(data.location.lon, data.location.lat),
                    data,
                    {
                        externalGraphic: "http://kaart.pdok.nl/api/markertypes/flag-blue.png",
                        graphicWidth: 32,
                        graphicHeight: 32,
                        fillOpacity: 1,
                        label: data.waarde,
                        fontColor: "#ff0000",
                        fontSize: "11px",
                        fontFamily: "Courier New, monospace",
                        fontWeight: "bold",
                        labelXOffset: "2",
                        labelYOffset: "-9",
                        labelOutlineColor: "white",
                        labelOutlineWidth: 2
                    }
            );
            Geotool.createWaterPopup(feature);
            features.push(feature);
         }

         api.featuresLayer.addFeatures(features);
         api.enablePopups();

    }

    // meetpunten
    var data_uri = "http://www.rijkswaterstaat.nl/apps/geoservices/rwsnl/?mode=features&projecttype=watertemperatuur&loadprojects=0";
    var request = OpenLayers.Request.GET({
        url: data_uri,
        callback: handler
    });

} );
</script>
<div id="map_762" class="olMap fullscreen"></div>
<style>
     /* popup content is a little wider */
    .olFramedCloudPopupContent {
        max-width: 600px !important;
    }
</style>
</body>
</html>
